<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: core/Environment.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: core/Environment.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import jhr from 'jhr';
import merge from 'merge';
import Scope from './Scope';
import SymbolParser from './SymbolParser';
import ResourceDirective from '../directives/ResourceDirective';
import SetDirective from '../directives/SetDirective';
import RequestDirective from '../directives/RequestDirective';
import CompileDirective from '../directives/CompileDirective';
import ParseDirective from '../directives/ParseDirective';
import UnknownDirectiveError from './UnknownDirectiveError';
import UnknownTypeError from './UnknownTypeError';

/**
 * Environment
 */
class Environment {

    constructor(types) {

        var agent = jhr.createAgent();

        this.directives = {
            $resource: new ResourceDirective(agent),
            $set: new SetDirective(),
            $request: new RequestDirective(agent),
            $compile: new CompileDirective(this),
            $parse: new ParseDirective(['$resource', '$set', '$request', '$compile', '$parse'], this)
        };

        this.envCtx = {
            $window: window,
            $document: document,
            $env: {}
        };

        this.types = types || {};

    }

    getDirectiveByName(name) {
        if (!this.directives.hasOwnProperty(name))
            throw new UnknownDirectiveError(name);
        return this.directives[name];
    }
    
    getTypeByName(name) {
        if (!this.types.hasOwnProperty(name))
            throw new UnknownTypeError(name);
        return this.types[name];
        
    }

    addVar(key, name) {
        this.envCtx.env[key] = name;
        return this;
    }

    addType(key, name) {
        this.types[key] = name;
        return this;
    }

    parse(tree, self, locals) {

        return this.getDirectiveByName('$parse').apply(tree,
            new Scope(this.envCtx, {$self: self, $local:locals||{}}, new SymbolParser()));
    }

    parseWithResource(tree, self, locals, cb) {
        return this.getDirectiveByName('$parse').applyWithResource(tree,
            new Scope(this.envCtx, {$self: self, $local:locals||{}}, new SymbolParser()),cb);
    }

}

export default Environment</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CompileDirective.html">CompileDirective</a></li><li><a href="Environment.html">Environment</a></li><li><a href="ES2015Error.html">ES2015Error</a></li><li><a href="ParseDirective.html">ParseDirective</a></li><li><a href="RequestDirective.html">RequestDirective</a></li><li><a href="ResourceDirective.html">ResourceDirective</a></li><li><a href="Scope.html">Scope</a></li><li><a href="SetDirective.html">SetDirective</a></li><li><a href="SymbolParser.html">SymbolParser</a></li><li><a href="UnknownDirectiveError.html">UnknownDirectiveError</a></li><li><a href="UnknownTypeError.html">UnknownTypeError</a></li><li><a href="Utils.html">Utils</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Sun Jul 12 2015 16:49:19 GMT-0400 (AST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
